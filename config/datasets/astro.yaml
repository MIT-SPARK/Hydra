---
map_window:
  type: spatial
  max_radius_m: 8.0
active_window:
  full_update_separation_s: 0.2
  volumetric_map:
    voxels_per_side: 16
    voxel_size: 0.1
    truncation_distance: 0.3
frontend:
  pgmo:
    time_horizon: 15.0
    d_graph_resolution: 2.5
    mesh_resolution: 0.005
  traversability_places:
    type: traversability
    estimator:
      type: HeightTraversabilityEstimator
      height_below: 0
      height_above: 0.5
      min_confidence: 1.0
      min_traversability: 1.0
      pessimistic: true
    clustering:
      type: BlockTraversabilityClustering
      min_place_width: &min_place_width 0.5 # m
      max_place_width: &max_place_width 1.0 # m
      recursive: true
      simplify_boundary_traversability: false
    sinks:
      - type: TraversabilityVisualizer
backend:
  add_places_to_deformation_graph: true
  optimize_on_lc: true
  enable_node_merging: true
  update_functors:
    agents:
      type: UpdateAgentsFunctor
    # objects:
    #   type: UpdateObjectsFunctor
    traversability:
      type: UpdateTraversabilityFunctor
      min_place_size: *min_place_width # m
      max_place_size: *max_place_width # m
      use_metric_distance: false
      tolerance: 0.1 # m
    rooms:
      type: UpdateRoomsFunctor
      room_finder:
        min_dilation_m: 0.5
        max_dilation_m: 1.2
        min_component_size: 10
        min_room_size: 10
        dilation_threshold_mode: PLATEAU
        min_lifetime_length_m: 0.1
        plateau_ratio: 0.15
        clustering_mode: NEIGHBORS
        dilation_diff_threshold_m: -1.0
    buildings:
      type: UpdateBuildingsFunctor
    zmq_labels:
      type: ZmqRoomLabelUpdater
  pgmo:
    run_mode: FULL # kimera_pgmo run mode FULL is required
    embed_trajectory_delta_t: 5.0
    num_interp_pts: 3
    interp_horizon: 10.0
    optimizer:
      type: KimeraRpgoOptimizer
      solver: LM
      gnc:
        inlier_probability: 0.9
        mu_step: 1.6
        max_iterations: 100
    add_initial_prior: true
    covariance:
      odom: 1.0e-02
      loop_close: 5.0e-02
      sg_loop_close: 1.0e-01
      prior: 1.0e-02
      mesh_mesh: 1.0e-02
      pose_mesh: 1.0e-02
      place_mesh: 1.0e-02
      place_edge: 10.0
      place_merge: 10.0
      object_merge: 10.0
